# git-secrets Configuration
#
# This file contains patterns to detect secrets in commits.
# 
# Installation:
#   1. Install git-secrets: https://github.com/awslabs/git-secrets
#      - macOS: brew install git-secrets
#      - Linux: git clone and make install
#   
#   2. Install hooks in this repository:
#      git secrets --install
#   
#   3. Register patterns from this file:
#      git secrets --register-aws
#      # Add custom patterns from this file
#
# Manual scan:
#   git secrets --scan
#   git secrets --scan-history

# AWS patterns (built-in with --register-aws)
# - AWS Access Key ID
# - AWS Secret Access Key
# - AWS Account ID
# - AWS Session Token

# Custom patterns for this project

# Admin API Key pattern (64 hex characters - our generated keys)
# Example: 7f9c8e2a5b1d4f6a8c3e7b9d2f5a8c1e4b7d9f2a5c8e1b4d7f9c2e5a8b1d4f6a
[0-9a-f]{64}

# Generic API key patterns
api[_-]?key[\"']?\s*[:=]\s*[\"']?[a-zA-Z0-9_\-]{20,}
apikey[\"']?\s*[:=]\s*[\"']?[a-zA-Z0-9_\-]{20,}

# Secret key patterns
secret[_-]?key[\"']?\s*[:=]\s*[\"']?[a-zA-Z0-9_\-]{20,}

# Token patterns
[_-]?token[\"']?\s*[:=]\s*[\"']?[a-zA-Z0-9_\-]{20,}
bearer[\"']?\s*[:=]\s*[\"']?[a-zA-Z0-9_\-]{20,}

# Password patterns (with quotes or assignment)
password[\"']?\s*[:=]\s*[\"']?[^\s\"']{8,}

# Environment variable assignments with sensitive values
ADMIN_API_KEY\s*=\s*[\"']?[a-zA-Z0-9_\-]{20,}
API_KEY\s*=\s*[\"']?[a-zA-Z0-9_\-]{20,}
SECRET\s*=\s*[\"']?[a-zA-Z0-9_\-]{20,}

# Database connection strings
(postgres|mysql|mongodb|redis)://[^\s\"']+:[^\s\"']+@

# Private keys
-----BEGIN (RSA |DSA |EC |OPENSSH )?PRIVATE KEY-----

# JWT tokens
eyJ[a-zA-Z0-9_-]{10,}\.[a-zA-Z0-9_-]{10,}\.[a-zA-Z0-9_-]{10,}

# Cloudflare API tokens
[a-zA-Z0-9_-]{40,}

# Generic base64 encoded secrets (40+ characters)
(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?[a-zA-Z0-9+/=]{40,}

# Allowed exceptions (patterns that should NOT be flagged)
# Use --allowed flag when adding exceptions

# Example development keys in documentation
dev-test-key
example-api-key
your-api-key
your-secret-key
my-secret-key
sk-test-
sk-dev-

# Placeholder patterns in example files
replace-with-
replace-me
changeme
CHANGE_THIS

# Test fixtures
test-api-key
mock-secret
dummy-token

# File patterns to always scan
*.ts
*.js
*.json
*.yaml
*.yml
*.toml
*.env*
*.vars*
*.sh
*.md

# Additional notes:
# - Files matching .gitignore patterns are automatically excluded
# - Use 'git secrets --scan' to manually check uncommitted changes
# - Use 'git secrets --scan-history' to check entire repository history
